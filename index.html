<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Home ‚Ä¢ Montafon Moonlight</title>

  <!-- Social / SEO -->
  <meta name="description" content="Montafon Moonlight ‚Äî a weekly translation from Korean by Jeong Chanju, following travelers drawn together by fate, choice, and the pursuit of absolute silence." />
  <link rel="canonical" href="https://omatty123.github.io/MontafonMoonlight/">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Home ‚Ä¢ Montafon Moonlight">
  <meta property="og:site_name" content="Montafon Moonlight">
  <meta property="og:description" content="Translated from Korean ‚Ä¢ Updates weekly">
  <meta property="og:url" content="https://omatty123.github.io/MontafonMoonlight/">
  <meta property="og:image" content="https://omatty123.github.io/MontafonMoonlight/assets/og-cover.jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Home ‚Ä¢ Montafon Moonlight">
  <meta name="twitter:description" content="Translated from Korean ‚Ä¢ Updates weekly">
  <meta name="twitter:image" content="https://omatty123.github.io/MontafonMoonlight/assets/og-cover.jpg">

  <!-- Fonts / Tailwind / Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" />

  <style>
    :root{ --bg:#ffffff; --text:#111827; --muted:#64748b; --card:#f8fafc; --border:#e5e7eb; --link:#2563eb; }
    html[data-theme="dark"]{ --bg:#0b1220; --text:#e5e7eb; --muted:#94a3b8; --card:#111827; --border:#243244; --link:#8ab4ff; }

    html,body{ background:var(--bg); color:var(--text); }
    a{ color:var(--link); text-decoration:none; }
    body,h1,h2,h3,h4,h5,h6,p,a,li,button,small,span,div{ font-family:'Inter',sans-serif !important; }

    header.stickybar{ position:sticky; top:0; z-index:40; background:var(--bg); border-bottom:1px solid var(--border); }
    .k-meta{ color:var(--muted); }

    .card{ background:var(--card); border:1px solid var(--border); border-radius:.75rem; overflow:hidden; transition:transform .2s, box-shadow .2s; }
    .card:hover{ transform:translateY(-2px); box-shadow:0 10px 25px rgba(0,0,0,.12); }
    .cover{ aspect-ratio:3/2; width:100%; object-fit:cover; }
    .badge{ background:var(--bg); color:var(--muted); border:1px solid var(--border); }

    /* ‚ú® Featured current chapter */
    .featured{ background:var(--card); border:1px solid var(--border); border-radius:1rem; overflow:hidden; margin-bottom:3rem; }
    .featured img{ width:100%; max-height:400px; object-fit:cover; }
  </style>
</head>

<body>
  <!-- Header -->
  <header class="stickybar">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between">
      <div class="min-w-0">
        <h1 class="font-bold text-2xl" style="color:#2563eb;">
          <i class="fas fa-book mr-2"></i> Montafon Moonlight
        </h1>
        <p class="text-sm k-meta">Translated from Korean ‚Ä¢ Updates weekly</p>
      </div>
      <button id="theme-toggle" class="p-2 rounded border k-meta" aria-label="Toggle theme">
        <i class="fas fa-moon"></i>
      </button>
    </div>
  </header>

  <!-- Hero / Title -->
  <section class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-10 pb-6 text-center">
    <h2 class="text-4xl font-bold mb-2">Montafon Moonlight</h2>
    <p class="text-lg k-meta mb-4">Î™¨ÌÉÄÌè∞Ïùò Îã¨Îπõ</p>
    <div class="flex justify-center space-x-6 text-sm k-meta">
      <span>Author: 
        <a href="/MontafonMoonlight/authors/jeong-chanju.html" class="hover:underline">
          Jeong Chanju
        </a>
      </span>
      <span><i class="fas fa-language mr-1"></i> Translator: Matty Wegehaupt</span>
      <span><i class="fas fa-calendar mr-1"></i> Started: August 2025</span>
    </div>
  </section>

  <!-- üïØÔ∏è Featured Current Chapter -->
  <section id="featured" class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <h3 class="text-2xl font-bold mb-4">Current Chapter</h3>
    <div id="current-chapter" class="featured shadow"></div>
  </section>

  <!-- Chapters grid -->
  <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-16">
    <h3 class="text-2xl font-bold mb-6">All Chapters</h3>
    <div id="grid" class="grid gap-8 sm:grid-cols-2 md:grid-cols-3"></div>
  </main>

  <!-- Footer -->
  <footer class="border-t py-8 text-center text-sm k-meta">
    <p>Translation ¬© <span id="copyYear"></span> ‚Ä¢
      <a href="http://www.mediabuddha.net/m/news/view.php?number=34752" class="underline">Support the original author</a>
    </p>
  </footer>

  <script>
    /* THEME */
    (function(){
      const KEY="theme", root=document.documentElement, btn=document.getElementById("theme-toggle");
      function apply(t){ t==="dark" ? root.setAttribute("data-theme","dark") : root.removeAttribute("data-theme"); }
      function initial(){ const s=localStorage.getItem(KEY); if(s==="dark"||s==="light") return s; return matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"; }
      function reflect(t){ if(!btn) return; btn.setAttribute("aria-pressed", t==="dark"?"true":"false"); const i=btn.querySelector("i"); if(i) i.className = t==="dark" ? "fas fa-sun" : "fas fa-moon"; }
      let cur=initial(); apply(cur); reflect(cur);
      matchMedia("(prefers-color-scheme: dark)").addEventListener?.("change",e=>{ if(localStorage.getItem(KEY)) return; cur=e.matches?"dark":"light"; apply(cur); reflect(cur); });
      btn?.addEventListener("click",()=>{ cur=cur==="dark"?"light":"dark"; localStorage.setItem(KEY,cur); apply(cur); reflect(cur); });
    })();

    const $ = s=>document.querySelector(s);
    const fmtDate = d=> new Date(d).toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'});

    function cardTemplate(ch, idx){
      const href = ch.href || `chapter.html?slug=${encodeURIComponent(ch.slug||"")}`;
      const titleHTML = (ch.slug === "cheonmaneyo" || ch.title === "Cheonmaneyo")
        ? '‚Äú<em>Cheonmaneyo</em>‚Äù'
        : (ch.title || `Chapter ${idx+1}`);
      const date = ch.date ? fmtDate(ch.date) : "‚Äî";
      const cover = ch.cover || "assets/placeholder.jpg";
      const installment = (typeof ch.installment === "number") ? ch.installment : (idx+1);

      return `
        <article class="card relative">
          <span class="badge absolute top-2 left-2 px-2 py-1 rounded text-xs font-semibold">#${installment}</span>
          <a href="${href}"><img src="${cover}" alt="${ch.title || 'Chapter'} cover" class="cover" loading="lazy"></a>
          <div class="p-4">
            <h4 class="text-lg font-semibold mb-1">
              <a href="${href}" class="hover:underline">${titleHTML}</a>
            </h4>
            <p class="text-sm k-meta mb-2">
              <i class="fas fa-calendar mr-1"></i> ${date}
            </p>
            <p class="text-sm">${ch.summary || ""}</p>
          </div>
        </article>`;
    }

    /* Render both Featured + Grid */
    async function renderChapters(){
      $("#copyYear").textContent = new Date().getFullYear();
      const url = 'chapters.json?v=' + Date.now();
      let list = [];

      try {
        const res = await fetch(url, { cache: 'no-store' });
        list = await res.json();
      } catch (e) {
        console.error('Failed to load chapters.json', e);
      }

      if (!Array.isArray(list) || !list.length) {
        $('#grid').innerHTML = '<div class="k-meta">No chapters yet.</div>';
        return;
      }

      // Sort by date ascending
      list.sort((a,b)=> new Date(a.date) - new Date(b.date));

      // Latest chapter = last item
      const latest = list[list.length - 1];
      const rest = list.slice(0, -1);

      // Featured section
      $('#current-chapter').innerHTML = `
        <div class="flex flex-col md:flex-row">
          <img src="${latest.cover}" alt="${latest.title}" class="w-full md:w-1/2 object-cover">
          <div class="p-6 text-left flex flex-col justify-center">
            <h4 class="text-2xl font-semibold mb-2">${latest.title}</h4>
            <p class="k-meta mb-3"><i class="fas fa-calendar mr-1"></i> ${fmtDate(latest.date)}</p>
            <p class="mb-4">${latest.summary}</p>
            <a href="chapter.html?slug=${latest.slug}" class="text-white bg-blue-600 px-4 py-2 rounded font-semibold hover:bg-blue-700 inline-block w-max">Read Now</a>
          </div>
        </div>`;

      // All chapters grid
      $('#grid').innerHTML = rest.map((ch,i)=>cardTemplate(ch,i)).join('');
    }

    renderChapters();
  </script>
</body>
</html>
